version: 1.0
provider:
  name: openfaas
  gateway: http://10.0.1.2:8080

functions:
  shorten-url:
    lang: dockerfile
    handler: ./openfaas/shorten-url
    image: masondrake/shorten-url:latest
    environment:
      DYNAMODB_ENDPOINT: http://10.0.1.2:8000
      AWS_REGION: us-east-1
      AWS_ACCESS_KEY_ID: local
      AWS_SECRET_ACCESS_KEY: local
      DYNAMODB_TABLE: url_mappings
      SHORT_DOMAIN: https://url.masondrake.dev
      content_type: application/json
    annotations:
      cors-allow-origin: "*"
      cors-allow-methods: "GET,POST,PUT,DELETE,OPTIONS"
      cors-allow-headers: "Content-Type,Authorization"
    labels:
      com.openfaas.scale.min: "1"
      com.openfaas.scale.max: "5"
    build_args:
      ADDITIONAL_PACKAGE: ""

  redirect-url:
    lang: dockerfile
    handler: ./openfaas/redirect-url
    image: masondrake/redirect-url:latest
    environment:
      DYNAMODB_ENDPOINT: http://10.0.1.2:8000
      AWS_REGION: us-east-1
      AWS_ACCESS_KEY_ID: local
      AWS_SECRET_ACCESS_KEY: local
      DYNAMODB_TABLE: url_mappings
      content_type: application/json
    annotations:
      cors-allow-origin: "*"
      cors-allow-methods: "GET,POST,PUT,DELETE,OPTIONS"
      cors-allow-headers: "Content-Type,Authorization"
    labels:
      com.openfaas.scale.min: "1"
      com.openfaas.scale.max: "5"
    build_args:
      ADDITIONAL_PACKAGE: ""
